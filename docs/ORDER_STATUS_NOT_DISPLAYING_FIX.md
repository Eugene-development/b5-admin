# Исправление: Статус заказа "Не указано" в b5-admin

## Проблема

При создании нового заказа в b5-admin статус отображается как "Не указано", хотя в базе данных статус установлен правильно.

## Диагностика показала

✅ **API работает правильно**:
- Дефолтный статус существует в БД
- Статус устанавливается при создании заказа
- GraphQL запрос включает загрузку связи `status`

❌ **Проблема в отображении**:
- В базе данных: `status_id` заполнен
- В GraphQL ответе: `status` возвращает `null`
- В интерфейсе: отображается "Не указано"

## Причина

Кеш GraphQL на сервере не обновился после добавления поля `status_id` и связи `status` в модель Order.

## Решение

Проблема была в том, что GraphQL мутации `createOrder` и `updateOrder` не загружали связи `status` и `partnerPaymentStatus`.

### Исправление

Обновлены мутации в `src/lib/api/orders.js`:

**Добавлены поля в ответ мутаций:**
```graphql
partner_payment_status_id
status_id
partnerPaymentStatus {
    id
    code
    name
}
status {
    id
    slug
    value
    color
    sort_order
}
```

Теперь при создании или обновлении заказа связи загружаются автоматически, и статус отображается сразу без необходимости обновления страницы.

## Проверка после исправления

1. Создать новый заказ в b5-admin
2. Статус должен отображаться сразу как "Сформирован"
3. Не нужно нажимать кнопку "Обновить"

## Дата исправления
23 декабря 2024
