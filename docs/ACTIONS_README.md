# –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ü–∏–π - README

## üìã –°—Ç–∞—Ç—É—Å

‚úÖ **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏  
‚è≥ **–ë—ç–∫–µ–Ω–¥**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è GraphQL API  
üîß **API —Ñ—É–Ω–∫—Ü–∏–∏**: –ì–æ—Ç–æ–≤—ã, –Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±—ç–∫–µ–Ω–¥–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢–µ–∫—É—â–∞—è —Ä–∞–±–æ—Ç–∞ (—Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/actions` —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ü–∏–π
- –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- –ò—Å–∫–∞—Ç—å –∞–∫—Ü–∏–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∫–æ–º–ø–∞–Ω–∏–∏, —Ä–µ–≥–∏–æ–Ω—É
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∞–∫—Ü–∏–∏

**–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞** –∏ –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API

1. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ –±—ç–∫–µ–Ω–¥** (–ø–æ–¥—Ä–æ–±–Ω–æ –≤ `ACTIONS_API_BACKEND.md`):

   ```bash
   cd b5-db-2
   php artisan migrate
   # –î–æ–±–∞–≤—å—Ç–µ GraphQL —Å—Ö–µ–º—É
   php artisan lighthouse:clear-cache
   ```

2. **–í–∫–ª—é—á–∏—Ç–µ API** (–ø–æ–¥—Ä–æ–±–Ω–æ –≤ `ACTIONS_ENABLE_API.md`):
   - –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–º–ø–æ—Ä—Ç—ã –≤ `+page.js` –∏ `+page.svelte`
   - –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—ã–∑–æ–≤—ã API —Ñ—É–Ω–∫—Ü–∏–π
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
b5-admin/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ actions.js              # ‚úÖ API —Ñ—É–Ω–∫—Ü–∏–∏ (–≥–æ—Ç–æ–≤—ã)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ActionAddModal.svelte   # ‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
‚îÇ   ‚îî‚îÄ‚îÄ routes/(protected)/actions/
‚îÇ       ‚îú‚îÄ‚îÄ +page.svelte                # ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ (–º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îÇ       ‚îî‚îÄ‚îÄ +page.js                    # ‚úÖ –ó–∞–≥—Ä—É–∑—á–∏–∫ (–º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ ACTIONS_README.md               # üìñ –≠—Ç–æ—Ç —Ñ–∞–π–ª
    ‚îú‚îÄ‚îÄ ACTION_ADD_FEATURE.md           # üìñ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
    ‚îú‚îÄ‚îÄ ACTIONS_API_BACKEND.md          # üìñ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±—ç–∫–µ–Ω–¥—É
    ‚îî‚îÄ‚îÄ ACTIONS_ENABLE_API.md           # üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è API

b5-db-2/
‚îî‚îÄ‚îÄ database/migrations/
    ‚îî‚îÄ‚îÄ 2025_11_10_120000_create_actions_table.php  # ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è
```

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç ActionAddModal

- ‚úÖ –§–æ—Ä–º–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –í—ã–±–æ—Ä –∫–æ–º–ø–∞–Ω–∏–∏ –∏–∑ —Å–ø–∏—Å–∫–∞
- ‚úÖ –í—ã–±–æ—Ä –¥–∞—Ç –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- ‚úÖ –ß–µ–∫–±–æ–∫—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (ARIA, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞)

### API —Ñ—É–Ω–∫—Ü–∏–∏ (–≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)

- ‚úÖ `createAction()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Ü–∏–∏
- ‚úÖ `updateAction()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ü–∏–∏
- ‚úÖ `deleteAction()` - —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫—Ü–∏–∏
- ‚úÖ `refreshActions()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
- ‚úÖ `getCompaniesForActions()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–π

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ /actions

- ‚úÖ –°–ø–∏—Å–æ–∫ –∞–∫—Ü–∏–π —Å –ø–æ–∏—Å–∫–æ–º
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ü–∏—é"
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –ù–∞ –±—ç–∫–µ–Ω–¥–µ (b5-api-2)

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é**:

   ```bash
   cd b5-db-2
   php artisan migrate
   ```

2. **–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å** `app/Models/Action.php`:

   ```php
   <?php
   namespace App\Models;
   use Illuminate\Database\Eloquent\Model;
   use Illuminate\Database\Eloquent\Concerns\HasUlids;

   class Action extends Model
   {
       use HasUlids;

       protected $fillable = [
           'name', 'description', 'start', 'end',
           'company_id', 'is_active'
       ];

       protected $casts = [
           'start' => 'date',
           'end' => 'date',
           'is_active' => 'boolean',
       ];

       public function company()
       {
           return $this->belongsTo(Company::class);
       }
   }
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å GraphQL —Å—Ö–µ–º—É** –≤ `graphql/schema.graphql` (—Å–º. `ACTIONS_API_BACKEND.md`)

4. **–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à**:
   ```bash
   php artisan lighthouse:clear-cache
   ```

### –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (b5-admin)

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±—ç–∫–µ–Ω–¥–∞:

1. **–í —Ñ–∞–π–ª–µ `+page.js`** —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:

   ```javascript
   import { refreshActions, getCompaniesForActions } from '$lib/api/actions.js';
   ```

2. **–í —Ñ–∞–π–ª–µ `+page.svelte`** —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:

   ```javascript
   import { createAction, refreshActions } from '$lib/api/actions.js';
   ```

3. **–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã API** –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö `handleSaveNewAction` –∏ `refreshData`

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `ACTIONS_ENABLE_API.md`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–µ–Ω–¥–∞

```bash
curl -X POST http://localhost:8000/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ actions(first: 1) { data { id name } } }"}'
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:5173/actions`
2. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ü–∏—é"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É
4. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ü–∏—é"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–∫—Ü–∏—è –ø–æ—è–≤–∏–ª–∞—Å—å –≤ —Å–ø–∏—Å–∫–µ

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **ACTION_ADD_FEATURE.md** - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- **ACTIONS_API_BACKEND.md** - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±—ç–∫–µ–Ω–¥—É –∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
- **ACTIONS_ENABLE_API.md** - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è API
- **CHANGELOG_ACTIONS.md** - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## ‚ùì FAQ

**Q: –ü–æ—á–µ–º—É —è –≤–∏–∂—É –æ—à–∏–±–∫—É "Cannot query field 'actions'"?**  
A: –ë—ç–∫–µ–Ω–¥ API –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**Q: –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**  
A: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –º–æ–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è API –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –ë–î.

**Q: –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ API –≥–æ—Ç–æ–≤?**  
A: –í—ã–ø–æ–ª–Ω–∏—Ç–µ curl-–∑–∞–ø—Ä–æ—Å –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ". –ï—Å–ª–∏ –Ω–µ—Ç –æ—à–∏–±–∫–∏ - API –≥–æ—Ç–æ–≤.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–µ–π—á–∞—Å?**  
A: –î–∞! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è UI.

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Laravel (`storage/logs/laravel.log`)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GraphQL —Å—Ö–µ–º—É –≤ Playground
